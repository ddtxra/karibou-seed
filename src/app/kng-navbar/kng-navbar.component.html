
<!-- NAVIGATION  -->
<mdc-drawer drawer='temporary' #navigation [fixed]="true" >
  <mdc-drawer-header>
      <img [src]="config.shared.home.siteName.image" />
  </mdc-drawer-header>
  <mdc-drawer-content >

    <mdc-list-group>
      <mdc-list>
        <a class="title1" mdc-list-item [routerLink]="['/']"><span [innerHtml]="config.shared.home.tagLine.t[locale]"></span></a>
        <mdc-list-item class="hide">
          <div class="align-days">
            <div class="label-shipping" *ngFor="let day of getShippingWeek()">
            {{day.label}} <span class="bullet {{day.state}}"></span>
            </div>
          </div>
        </mdc-list-item>    
        <mdc-list-divider></mdc-list-divider>      
        <mdc-list-item [routerLink]="['/store',store,'me']" [hidden]="!user.isAuthenticated()">
          <mdc-icon mdc-list-item-graphic>account_box</mdc-icon><span i18n>Votre compte</span>
        </mdc-list-item>
        <mdc-list-item [routerLink]="['/store',store,'me','login']" [hidden]="user.isAuthenticated()">
          <mdc-icon mdc-list-item-graphic>account_circle</mdc-icon><span i18n>Connectez-vous</span>
        </mdc-list-item>
              
        <mdc-list-divider></mdc-list-divider>
        <mdc-list-item i18n class="bold">
          <mdc-icon mdc-list-item-graphic>directions_bike</mdc-icon>
          Prochaines livraisons
        </mdc-list-item>
        <mdc-list-item *ngFor="let day of getShippingDays();let idx=index" 
                       [selected]="day.equalsDate(currentShippingDay)"
                       (click)="doSetCurrentShippingDay($event,day,idx)">
            <mdc-icon mdc-list-item-graphic>radio_button_checked</mdc-icon>
            {{day|date:'EEEE d MMMM':'':'fr'}}&nbsp;
            <!-- <mdc-icon mdc-list-item-meta>info</mdc-icon>                 -->
        </mdc-list-item>
        <mdc-menu-divider></mdc-menu-divider>
      </mdc-list>
    </mdc-list-group>
    <!-- ADMIN -->
    <mdc-list-group class="admin" [hidden]="!$navigation.isAdmin">
      <mdc-list-item i18n>
        <mdc-icon mdc-list-item-graphic>settings</mdc-icon>
        Admin
      </mdc-list-item>
      <mdc-menu-divider></mdc-menu-divider>
      <mdc-list-item [id]="20+i" class="admin-item" 
        *ngFor="let menu of $navigation.getMenuItems('admin');let i=index;" 
        [routerLink]="getRouterLink(menu.url)"><mdc-icon  mdc-list-item-graphic>radio_button_checked</mdc-icon>&nbsp;{{menu.name[locale]}}
      </mdc-list-item>
    </mdc-list-group>
  </mdc-drawer-content>
</mdc-drawer>

<!-- CART SIDEBAR -->
<!-- <mdc-drawer drawer='temporary' #cart [fixed]="true" dir="rtl" class="right">
  <mdc-drawer-content dir="ltr">
    <kng-cart></kng-cart>
  </mdc-drawer-content>
</mdc-drawer> -->

<!-- MAIN LAYOUT -->
<div [hidden]="!isAppReady()" class="navbar">      

  <!--- [dense]="$navigation.isMobileOrTablet()" -->
  <mdc-app-bar #appbar fixed="false"  dense="true">
    <mdc-app-bar-row>
      <!-- APPBAR-SECTION-START -->
      <mdc-app-bar-section align="start">
        <mdc-icon mdcAppBarNavIcon (click)="navigation.open()"  class="">update</mdc-icon>
        <mdc-app-bar-title>{{title}}</mdc-app-bar-title>
      </mdc-app-bar-section>       
      <!-- APP BAR MENU ICON --> 
      <mdc-app-bar-section align="end">
          <a (click)="shipping.open()" mdcAppBarActionItem class="hide btn-shipping" >
              <i material-icon >update</i>
              <span class="hide" [class.primary]="$navigation.isMobileOrTablet()" i18n>Prochaines livraisons</span>          
          </a>
          <a (click)="admin.open()" class="hide" mdcAppBarActionItem material-icon [hidden]="!user.isAdmin()">vpn_key</a>        
          <a [routerLink]="['/store',store,'me']"  mdcAppBarActionItem material-icon [hidden]="!user.isAuthenticated()">account_box</a>        
          <a [routerLink]="['/store',store,'me','login']"  mdcAppBarActionItem material-icon [hidden]="user.isAuthenticated()">account_circle</a>        
    
          <button mdc-toolbar-icon material-icon class="hide mat-toolbar--open-search mat-search--mobile ">search</button>
          <!-- menu content anchor to toolbar-section -->
          <mdc-menu #shipping [anchorCorner]="'bottom-start'">
            <mdc-menu-item id="0" *ngFor="let day of getShippingDays();let idx=index" (click)="doSetCurrentShippingDay($event,day,idx)">
                {{day|date:'EEEE d MMMM':'':'fr'}}&nbsp;
                <mdc-icon mdc-list-item-meta>info</mdc-icon>                
            </mdc-menu-item>
            <mdc-menu-divider></mdc-menu-divider>
            <mdc-menu-item [disabled]="true" >
                <!-- <h5 i18n>Ouverture</h5> -->
                <div class="align-days">
                  <div class="label-shipping" *ngFor="let day of getShippingWeek()">
                  {{day.label}} <span class="bullet {{day.state}}"></span>
                </div>
              </div>
            </mdc-menu-item>
          </mdc-menu>
          <mdc-menu #admin>
            <!-- FOR ADMIN -->
            <mdc-menu-item [id]="20+i" class="admin-item" 
                           [hidden]="!$navigation.isAdmin"
                           *ngFor="let menu of $navigation.getMenuItems('admin');let i=index;" 
                           [routerLink]="getRouterLink(menu.url)"><mdc-icon>radio_button_checked</mdc-icon>&nbsp;{{menu.name.fr}}</mdc-menu-item>
          </mdc-menu>
          <mdc-menu #profile [anchorCorner]="'bottom-start'">
            <mdc-menu-item id="0" [routerLink]="['/store',store,'me','orders']"><mdc-icon>favorite</mdc-icon>&nbsp;<span i18n>Bonjour</span>&nbsp;{{user?.name.givenName}}</mdc-menu-item>
            <mdc-menu-divider></mdc-menu-divider>
            <mdc-menu-item id="1" [routerLink]="['/store',store,'me','logout']"><mdc-icon>exit_to_app</mdc-icon>&nbsp;<span i18n>Logout</span></mdc-menu-item>
            <!--
            <mdc-menu-divider></mdc-menu-divider>
            <mdc-menu-item id="3" *ngIf="user.shops.length" [routerLink]="['/store',store,'shop',user.shops[0].urlpath,'edit']"><mdc-icon>mode_edit</mdc-icon><span i18n>Editer</span> {{user.shops[0].name}}</mdc-menu-item>           
            -->
          </mdc-menu>                              
  
      </mdc-app-bar-section>
    </mdc-app-bar-row>
    <mdc-app-bar-row [hidden]="$navigation.isAdminLayout">
      <!-- APPBAR-SECTION-START -->
      <mdc-app-bar-section align="start"></mdc-app-bar-section>

      <!-- APPBAR-SECTION-MIDDLE -->
      <!-- NOTE: [routerLinkActiveOptions]="{exact:true}" ONLY FOR LINK == '/' -->
      <mdc-app-bar-section #section>
        <mdc-tab-bar>
          <mdc-tab *ngFor="let menu of primary;let idx=index;" 
                    [routerLink]="'.'+menu.url"                     
                    mdcRouter routerLinkActive #rla="routerLinkActive">
            <span [innerHTML]="menu.name[locale]"></span>
          </mdc-tab>
        </mdc-tab-bar>        
      
        <!-- <mdc-tab-bar-scroller>
          <mdc-tab-bar-scroll-back>
            <mdc-icon>navigate_before</mdc-icon>
          </mdc-tab-bar-scroll-back>
          <mdc-tab-bar-scroll-frame>        
          </mdc-tab-bar-scroll-frame>              
          <mdc-tab-bar-scroll-forward>
            <mdc-icon>navigate_next</mdc-icon>
          </mdc-tab-bar-scroll-forward>
        </mdc-tab-bar-scroller> -->
      </mdc-app-bar-section>      

      <!-- APPBAR-SECTION-END -->
      <mdc-app-bar-section align="end" class="" >
      </mdc-app-bar-section>
    </mdc-app-bar-row>
  </mdc-app-bar>


  <!-- CONTENT APP -->
  <div class="mdc-content">
    <ng-content></ng-content>
  </div>

  <!-- BOTTOM APP BAR-->
  <mdc-app-bar hidden #bottombar fixed="false"  dense="true" class="mdc-bottom-app-bar">
    <mdc-app-bar-row>
      <!-- APPBAR-SECTION-START -->
      <mdc-app-bar-section align="start">
        <mdc-icon mdcAppBarNavIcon (click)="navigation.open()"  class="">update</mdc-icon>
        <mdc-app-bar-title>{{title}}</mdc-app-bar-title>
      </mdc-app-bar-section>       
    </mdc-app-bar-row>
  </mdc-app-bar>
  
  
  <!-- FOOTER -->
  <kng-footer></kng-footer>  
</div>
